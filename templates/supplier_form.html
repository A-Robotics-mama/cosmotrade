<!-- templates/supplier_form.html -->
{% extends 'base.html' %}
{% load static %}

{% block title %}Add Supplier - Cosmotrade CRM{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8 col-md-10">
        <div class="card shadow-sm border-0">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0"><i class="fas fa-building me-2"></i>Add New Supplier</h4>
            </div>
            <div class="card-body p-4">
                <form method="POST">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label for="legal_name" class="form-label">Legal Name</label>
                        <input type="text" class="form-control" id="legal_name" name="legal_name" required>
                    </div>
                    <div class="mb-3">
                        <label for="country_display" class="form-label">Country</label>
                        <input type="text" class="form-control" id="country_display" name="country_display">
                        <input type="hidden" id="country" name="country">
                    </div>
                    <div class="mb-3">
                        <label for="str_address" class="form-label">Street Address</label>
                        <input type="text" class="form-control" id="str_address" name="str_address">
                    </div>
                    <div class="mb-3">
                        <label for="bank" class="form-label">Bank</label>
                        <input type="text" class="form-control" id="bank" name="bank">
                    </div>
                    <div class="mb-3">
                        <label for="bank_address" class="form-label">Bank Address</label>
                        <input type="text" class="form-control" id="bank_address" name="bank_address">
                    </div>
                    <div class="mb-3">
                        <label for="bic" class="form-label">BIC</label>
                        <input type="text" class="form-control" id="bic" name="bic" maxlength="25">
                    </div>
                    <div class="mb-3">
                        <label for="bank_acc" class="form-label">Bank Account</label>
                        <input type="text" class="form-control" id="bank_acc" name="bank_acc" maxlength="50">
                    </div>
                    <div class="mb-3">
                        <label for="supplier_code" class="form-label">Supplier Code</label>
                        <input type="text" class="form-control" id="supplier_code" name="supplier_code" maxlength="3" required>
                    </div>
                    <div class="mb-3">
                        <label for="phone" class="form-label">Phone</label>
                        <input type="text" class="form-control" id="phone" name="phone" maxlength="20">
                    </div>
                    <div class="mb-3">
                        <label for="mobile" class="form-label">Mobile</label>
                        <input type="text" class="form-control" id="mobile" name="mobile" maxlength="20">
                    </div>
                    <div class="mb-3">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" class="form-control" id="email" name="email" maxlength="255">
                    </div>
                    <div class="mb-3">
                        <label for="instagram" class="form-label">Instagram</label>
                        <input type="text" class="form-control" id="instagram" name="instagram" maxlength="255">
                    </div>
                    <div class="mb-3">
                        <label for="web" class="form-label">Website</label>
                        <input type="text" class="form-control" id="web" name="web" maxlength="255">
                    </div>
                    <div class="mb-3">
                        <label for="contact_person" class="form-label">Contact Person</label>
                        <input type="text" class="form-control" id="contact_person" name="contact_person" maxlength="255">
                    </div>
                    <div class="mb-3">
                        <label for="notes" class="form-label">Notes</label>
                        <textarea class="form-control" id="notes" name="notes" rows="3"></textarea>
                    </div>
                    <div class="d-flex justify-content-end">
                        <button type="submit" class="btn btn-primary"><i class="fas fa-save me-2"></i>Save Supplier</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
$(document).ready(function() {
    $("#country_display").autocomplete({
        source: function(request, response) {
            $.ajax({
                url: "{% url 'suppliers:country_autocomplete' %}",
                dataType: "json",
                data: {
                    term: request.term
                },
                success: function(data) {
                    response($.map(data, function(item) {
                        return {
                            label: item.label,
                            value: item.label,
                            code: item.id
                        };
                    }));
                },
                error: function(xhr, status, error) {
                    console.error("Autocomplete request failed: ", status, error);
                }
            });
        },
        minLength: 1,
        select: function(event, ui) {
            $("#country").val(ui.item.code);
            $("#country_display").val(ui.item.label);
        }
    });
});
</script>
{% endblock %}